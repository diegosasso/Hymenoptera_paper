---
title: "Pairwise correlation"
date: "`r Sys.Date()`"
output: 
  html_document:
    df_print: paged
---



```{r setup, include=F}

library(ape)
library(phytools)
library(ontophylo)
library(dplyr)
library(parallel)
library(viridis)
library(ggplot2)
library(deeptime)
library(mgcv)
source("R/utils-ST.R")
source('R/region_class.R')


knitr::opts_chunk$set(
  echo = TRUE,       # show code by default
  warning = FALSE,
  message = FALSE
)
```


## Read and Make Data
```{r}
tree <-readRDS("data/hym_tree.RDS")

# read mean rates
rates <-readRDS("data_out/br_rates_all_ind.RDS")
rates <- do.call(cbind,rates)
# drop larva
#rates <- rates[,-16]
class(rates)
dim(rates)
```

## Corr

```{r}
corr <- cor_trimmed(rates, 
            method = "pearson", 
            log_transform = T, 
            log_const = 1e-6,
            trim_quantiles = c(0.01, 0.99),
            use = "pairwise.complete.obs")
```

```{r}
corr <- abs(corr)
max(corr)

corr
```

